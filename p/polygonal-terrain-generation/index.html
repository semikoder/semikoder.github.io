<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='3D procedural terrain generation using voronoi polygons'><title>Polygonal Terrain Generation</title>

<link rel='canonical' href='https://semikoder.github.io/p/polygonal-terrain-generation/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Polygonal Terrain Generation'>
<meta property='og:description' content='3D procedural terrain generation using voronoi polygons'>
<meta property='og:url' content='https://semikoder.github.io/p/polygonal-terrain-generation/'>
<meta property='og:site_name' content='SemiKoder'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='3D' /><meta property='article:published_time' content='2021-11-19T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2021-11-19T00:00:00&#43;00:00'/><meta property='og:image' content='https://semikoder.github.io/p/polygonal-terrain-generation/polygonal_terrain_generation_1.png' />
<meta name="twitter:title" content="Polygonal Terrain Generation">
<meta name="twitter:description" content="3D procedural terrain generation using voronoi polygons"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://semikoder.github.io/p/polygonal-terrain-generation/polygonal_terrain_generation_1.png' />
    </head>
    <body class="
    article-page 
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            localStorage.setItem(colorSchemeKey, "auto");
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        on-phone--column extended
    
">
    
        <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_huda2458f72ce188392d75c5d51cd8e24e_373_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">üê£</span>
                
            </figure>
            
        
        
        <h1 class="site-name"><a href="/">SemiKoder</a></h1>
        <h2 class="site-description">SemiKoder&#39;s Portfolio</h2><ol class="social-menu">
                
                    <li>
                        <a 
                            href='https://github.com/SemiKoder'
                            target="_blank"
                            title="GitHub"
                        >
                            
                            
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                            
                        </a>
                    </li>
                
            </ol></header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/projects' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Projects</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        
    </ol>
</aside>

    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/polygonal-terrain-generation/">
                <img src="/p/polygonal-terrain-generation/polygonal_terrain_generation_1_hucee10becb4d1cd630c80bc244da2cc2e_236258_800x0_resize_box_3.png"
                        srcset="/p/polygonal-terrain-generation/polygonal_terrain_generation_1_hucee10becb4d1cd630c80bc244da2cc2e_236258_800x0_resize_box_3.png 800w, /p/polygonal-terrain-generation/polygonal_terrain_generation_1_hucee10becb4d1cd630c80bc244da2cc2e_236258_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="803" 
                        loading="lazy"
                        alt="Featured image of post Polygonal Terrain Generation" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/unity/" style="background-color: #2a9d8f; color: #fff;">
                Unity
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/polygonal-terrain-generation/">Polygonal Terrain Generation</a>
    </h2>

    
    <h3 class="article-subtitle">
        3D procedural terrain generation using voronoi polygons
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Nov 19, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <p>This project is based on: <a class="link" href="http://www-cs-students.stanford.edu/~amitp/game-programming/polygon-map-generation/"  target="_blank" rel="noopener"
    >http://www-cs-students.stanford.edu/~amitp/game-programming/polygon-map-generation/</a></p>
<p>Couple days ago, I came across this interesting article called &ldquo;Polygonal Map Generation for Games&rdquo;. At first glance, I wasn&rsquo;t entirely interested, as I mostly generate my terrain using perlin noise. This is a much easier implementation - Unity&rsquo;s Math library officially supports perlin noise, making it easier for Unity users to implement perlin noise based terrains.
However, the maps generated by perlin noise aren&rsquo;t entirely good for creating island maps. Sure, there is a workaround for it, but it&rsquo;s always hard to get an island looking map just by using perlin noise. They often end up less realistic maps that look like a noise if seen from the top view. Otherwise, if the map has a fixed size in general, polygonal map generation would work much better. There will always be just one mountain where player can go on top of, unlike the noise function.</p>
<p>A voronoi diagram has been calculated using csDelaunay library (<a class="link" href="https://github.com/PouletFrit/csDelaunay%29"  target="_blank" rel="noopener"
    >https://github.com/PouletFrit/csDelaunay)</a>.
When you pick random points and generate Voronoi polygons, the maps tend to look very irregular. These irregular polygons are definitely not what we want for a terrain. If maps were generated directly using the edges would look rough. This is where the Lloyd&rsquo;s algorithm and relaxation comes in. Using multiple relaxation iterations, we can make the voronoi polygon map a lot more smoother and distribute the polygons evenly. Therefore, making the map look smoother.</p>
<p>During the map data generation, the following information needs to be calculated: adjacent polygon (neighbor cells), edges, island. Using these information, elevation of the terrain as well as the biome can be calculated. Once the island coast has been generated, we can fill the selected island with land, others with water.
Calculating the elevation is quite easy (compared to perlin noise), as I just took the distance of a cell from the coast and used that information for elevation. So the center cell of the whole island would have the highest elevation.</p>
<p>Finally, the data goes through a so-called &ldquo;Elevation Curve&rdquo;, which lowers the lower part of the terrain further more, while making elevated terrains even more elevated. A flat curve (constant 1) would make a minimal difference between the lower part and the higher part of the terrain.</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 151; 
			flex-basis: 364px"
	>
	<a href="/p/polygonal-terrain-generation/elevation_curve.png" data-size="882x581">
		<img src="/p/polygonal-terrain-generation/elevation_curve.png"
			width="882"
			height="581"
			srcset="/p/polygonal-terrain-generation/elevation_curve_hube2dca81c404bae52839c5a745d48d6e_16638_480x0_resize_box_3.png 480w, /p/polygonal-terrain-generation/elevation_curve_hube2dca81c404bae52839c5a745d48d6e_16638_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="Elevation Curve">
	</a>
	
	<figcaption>Elevation Curve</figcaption>
	
</figure></p>
<p>Once all the data has been generated, it was all about generating the mesh (with mesh colliders), translating the generated data to a texture then assigning the texture to the mesh. Except, I had to create the height map for the mesh separately (in float[,] variable), so that I could assign this variable to the terrain mesh directly.</p>
<p>You might notice that the generated map looks a little bit &ldquo;pixelated&rdquo;. This is because Unity has a limit on how many vertices one mesh object can have. It&rsquo;s generally not a good practice have a lot of vertices on a single mesh. A workaround for this would be separating the terrain mesh into different parts (in this case, into 4 smaller mesh objects) and connecting them together. Similar to Minecraft&rsquo;s implementation of chunks. This would also allow me to put multiple islands together.
Terrain&rsquo;s texture size in the pictures below have 200x200. Terrain textures bigger than this would exceed the maximum allowed number of verticies on the mesh.</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 99; 
			flex-basis: 239px"
	>
	<a href="/p/polygonal-terrain-generation/polygonal_terrain_generation_1.png" data-size="480x482">
		<img src="/p/polygonal-terrain-generation/polygonal_terrain_generation_1.png"
			width="480"
			height="482"
			srcset="/p/polygonal-terrain-generation/polygonal_terrain_generation_1_hucee10becb4d1cd630c80bc244da2cc2e_236258_480x0_resize_box_3.png 480w, /p/polygonal-terrain-generation/polygonal_terrain_generation_1_hucee10becb4d1cd630c80bc244da2cc2e_236258_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="Generated Map">
	</a>
	
	<figcaption>Generated Map</figcaption>
	
</figure>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 101; 
			flex-basis: 243px"
	>
	<a href="/p/polygonal-terrain-generation/polygonal_terrain_generation_2.png" data-size="493x485">
		<img src="/p/polygonal-terrain-generation/polygonal_terrain_generation_2.png"
			width="493"
			height="485"
			srcset="/p/polygonal-terrain-generation/polygonal_terrain_generation_2_huba0acb7d4647d13241af171f3c9daabf_246562_480x0_resize_box_3.png 480w, /p/polygonal-terrain-generation/polygonal_terrain_generation_2_huba0acb7d4647d13241af171f3c9daabf_246562_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="Generated Map2">
	</a>
	
	<figcaption>Generated Map2</figcaption>
	
</figure>
<figure 
	
		class="gallery-image" 
		style="
			flex-grow: 100; 
			flex-basis: 240px"
	>
	<a href="/p/polygonal-terrain-generation/polygonal_terrain_generation_3.png" data-size="483x481">
		<img src="/p/polygonal-terrain-generation/polygonal_terrain_generation_3.png"
			width="483"
			height="481"
			srcset="/p/polygonal-terrain-generation/polygonal_terrain_generation_3_hu187e00a2b9989cfbf5817d89ac3bf709_272803_480x0_resize_box_3.png 480w, /p/polygonal-terrain-generation/polygonal_terrain_generation_3_hu187e00a2b9989cfbf5817d89ac3bf709_272803_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="Generated Map3">
	</a>
	
	<figcaption>Generated Map3</figcaption>
	
</figure></p>
<p>I&rsquo;m happy with the end result, but its performance is not as good as if I were to generate using perlin noise. If I were to make a full map using this method of terrain generation (multiple islands), it would definitely be much harder for computers. To be fair, all of the calculations are done on a single thread, meaning the calculations that I&rsquo;ve performed was only done on a single core of a processor. Multi-threaded calculations would definitely be a lot better for the performance.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/3d/">3D</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/p/mesh-simplification-using-quadric-error-metrics/">
        
        

        <div class="article-details">
            <h2 class="article-title">Mesh Simplification using Quadric Error Metrics</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/one-room-survival/">
        
        
            <div class="article-image">
                <img src="/p/one-room-survival/oneroomsurvival.9fc4a4df05012e4ff6017e4621bada7c_hub38c463652888b1ca5a7643a7420d152_410020_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-n8Sk3wUBLk/2AX5GIbrafA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">One Room Survival</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/awaken-sentinel/">
        
        
            <div class="article-image">
                <img src="/p/awaken-sentinel/graphicsupdate.522323f081d71a3dd84a73d7f2f662d8_hu64b50e11776c16104a4e03122afb619f_1350265_250x150_fill_box_smart1_3.PNG" 
                        width="250" 
                        height="150" 
                        loading="lazy" 
                        data-key="" 
                        data-hash="md5-UiMj8IHXGj3YSnPX8vZi2A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Awaken Sentinel</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/scattered/">
        
        

        <div class="article-details">
            <h2 class="article-title">Scattered</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/p/replay/">
        
        

        <div class="article-details">
            <h2 class="article-title">Replay</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2017 - 
        
        2022 SemiKoder
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
